<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hireoscope - Company Details</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>

<body>
    <nav class="navbar sticky-top navbar-light bg-white p-3">
        <div class="container">
            <a class="navbar-brand fw-bold" href="#">Hireoscope</a>
        </div>
    </nav>

    <!-- ðŸŒŸ THYMELEAF FORM START -->
    <form id="companyForm" th:action="@{/submit-company}" th:object="${company}" method="post"
        enctype="multipart/form-data">
        <!-- Step 1 -->
        <div class="container-box" id="step1">
            <p class="text-muted">1/3 Company Details</p>
            <h2 class="text-center fw-bold">Tell us about your company</h2>

            <label class="text-label">Company Logo</label>
            <div class="text-center">
                <input type="file" name="logo" id="companyLogo" class="custom-input" accept="image/*">
                <img id="previewLogo" src="/images/default-logo.png" class="img-preview mt-2" width="100">
            </div>

            <label class="text-label">Company Name</label>
            <input type="text" th:field="*{companyName}" class="custom-input" placeholder="Company Name">

            <label class="text-label">Company Type</label>
            <select th:field="*{companyType}" class="custom-input">
                <option value="Private">Private</option>
                <option value="Public">Public</option>
                <option value="Government">Government</option>
                <option value="Non-Profit">Non-Profit</option>
            </select>
            <input type="hidden" name="email" th:value="${email}" />
            <label class="text-label">Industry</label>
            <input type="text" th:field="*{industry}" class="custom-input" placeholder="Industry Type">

            <label class="text-label">Company Size</label>
            <select th:field="*{companySize}" class="custom-input">
                <option value="It's just me">It's just me</option>
                <option value="2-9 employees">2-9 employees</option>
                <option value="10-99 employees">10-99 employees</option>
                <option value="100-1,000 employees">100-1,000 employees</option>
                <option value="More than 1,000 employees">More than 1,000 employees</option>
            </select>

            <label class="text-label">Company Website</label>
            <input type="url" th:field="*{companyWebsite}" class="custom-input" placeholder="Company Website">

            <label class="text-label">LinkedIn Profile</label>
            <input type="url" th:field="*{linkedinProfile}" class="custom-input" placeholder="LinkedIn Profile">
        </div>

        <!-- Step 2 -->
        <div class="container-box hidden" id="step2">
            <p class="text-muted">2/3 Company Contact</p>
            <h2 class="text-center fw-bold">Provide your contact details</h2>

            <label class="text-label">Phone Number</label>
            <input type="tel" th:field="*{companyPhone}" class="custom-input" placeholder="Enter phone number">

            <h4 class="text-label">Address Details</h4>

            <label class="text-label">City</label>
            <input type="text" th:field="*{city}" class="custom-input" placeholder="Enter city">

            <label class="text-label">State</label>
            <input type="text" th:field="*{state}" class="custom-input" placeholder="Enter state">

            <label class="text-label">Country</label>
            <input type="text" th:field="*{country}" class="custom-input" placeholder="Enter country">

            <label class="text-label">Pincode</label>
            <input type="text" th:field="*{pincode}" class="custom-input" placeholder="Enter pincode">
        </div>

        <!-- Step 3 -->
        <div class="container-box hidden" id="step3">
            <p class="text-muted">3/3 Company Information</p>
            <h2 class="fw-bold">Tell Us About Your Company</h2>
            <p>Provide a brief overview of your company, its mission, and what it does.</p>

            <textarea th:field="*{companyDescription}" id="jobDescription" class="form-control"
                placeholder="Type your company description here..." rows="5"></textarea>
            <div class="word-count"><span id="wordCount">0</span> / 50 words required</div>
            <div class="error-message hidden" id="errorMessage">
                <i class="fas fa-exclamation-circle"></i> Description must have at least 50 words.
            </div>
        </div>

        <!-- Navigation Buttons & Progress Bar -->
        <div class="progress-bar-container">
            <div class="progress-bar" id="progressBar"></div>
            <div class="nav-buttons">
                <button type="button" class="btn-custom btn-outline-dark" id="backBtn"><i class="fas fa-arrow-left"></i>
                    Back</button>
                <button type="button" class="btn-custom btn-dark" id="nextBtn">Next <i
                        class="fas fa-arrow-right"></i></button>
            </div>
        </div>
    </form>

    <!-- JavaScript Logic -->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            let currentStep = 1;
            const totalSteps = 3;

            const steps = document.querySelectorAll(".container-box");
            const progressBar = document.getElementById("progressBar");
            const backBtn = document.getElementById("backBtn");
            const nextBtn = document.getElementById("nextBtn");
            const jobDescription = document.getElementById("jobDescription");
            const wordCount = document.getElementById("wordCount");
            const errorMessage = document.getElementById("errorMessage");

            function updateStepAnimation(direction) {
                steps.forEach((step, index) => {
                    const stepNumber = index + 1;

                    if (stepNumber === currentStep) {
                        step.classList.remove('hidden', 'fade-out', 'slide-left', 'slide-right');
                        step.classList.add('fade-in');
                    } else {
                        step.classList.remove('fade-in');
                        step.classList.add(direction === "next" ? 'slide-left' : 'slide-right', 'fade-out');
                        setTimeout(() => step.classList.add('hidden'), 300);
                    }
                });

                progressBar.style.transition = "width 0.5s ease";
                progressBar.style.width = ((currentStep - 1) / (totalSteps - 1)) * 100 + "%";

                backBtn.style.display = "inline-block";
                nextBtn.innerHTML = currentStep === totalSteps ? "Submit" : `Next <i class="fas fa-arrow-right"></i>`;
            }

            nextBtn.addEventListener("click", function () {
                if (currentStep === 3) {
                    const words = jobDescription.value.trim().split(/\s+/).length;
                    if (words < 50) {
                        errorMessage.classList.remove("hidden");
                        return;
                    }
                }

                if (currentStep < totalSteps) {
                    currentStep++;
                    updateStepAnimation("next");
                } else {
                    document.getElementById("companyForm").submit();
                }
            });

            backBtn.addEventListener("click", function () {
                if (currentStep > 1) {
                    currentStep--;
                    updateStepAnimation("back");
                }
            });

            jobDescription.addEventListener("input", function () {
                const words = jobDescription.value.trim().split(/\s+/).length;
                wordCount.textContent = words;
                errorMessage.classList.toggle("hidden", words >= 50);
            });

            updateStepAnimation();
        });
    </script>
</body>

</html>